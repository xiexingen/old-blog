(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{376:function(e,s,t){"use strict";t.r(s);var r=t(1),n=Object(r.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"content"},[t("p",[e._v("Docker 安装MySql\n")]),t("blockquote",[t("p",[e._v("将docker容器中的实例中的文件跟物理文件链接起来 即使删掉容器 数据还在 再创建容器的时候 任然可以对应上之前的数据")])]),t("h4",{attrs:{id:"一、安装篇"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、安装篇","aria-hidden":"true"}},[e._v("#")]),e._v(" 一、安装篇")]),t("ol",[t("li",[e._v("使用docker-compose安装")])]),t("ul",[t("li",[e._v("[1.1] 在目录/docker/mysql/mysql-init下创建init-user.sql文件 内容如下")])]),t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("use mysql;\nCREATE USER 'sa'@'%' IDENTIFIED BY 'Abcd1234';\nGRANT ALL PRIVILEGES ON *.* TO 'sa'@'%';\n")])]),t("ul",[t("li",[e._v("[1.2]"),t("br"),e._v("\ndocker-compose -f mysql-docker-compose.yml up -d"),t("br"),e._v("\n对应的mysql-docker-compose.yml文件")])]),t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[e._v("version: "),t("span",{attrs:{class:"token string"}},[e._v("'2.3'")]),e._v("\n\nservices:\n  db:\n    image: mysql/mysql-server\n    container_name: mysql01\n    restart: always\n    command: mysqld --character-set-server"),t("span",{attrs:{class:"token operator"}},[e._v("=")]),e._v("utf8 --collation-server"),t("span",{attrs:{class:"token operator"}},[e._v("=")]),e._v("utf8_general_ci\n    ports:\n      - 3306:3306\n"),t("span",{attrs:{class:"token comment"}},[e._v("# networks:")]),e._v("\n"),t("span",{attrs:{class:"token comment"}},[e._v("#   - net_mysql")]),e._v("\n    environment:\n      MYSQL_ROOT_PASSWORD: Abcd1234\n    volumes:\n      - /docker/mysql/mysql-init:/docker-entrypoint-initdb.d\n      - /docker/mysql/data:/var/lib/mysql\n"),t("span",{attrs:{class:"token comment"}},[e._v("# volumes:")]),e._v("\n"),t("span",{attrs:{class:"token comment"}},[e._v("#   mysql-data:")]),e._v("\n"),t("span",{attrs:{class:"token comment"}},[e._v("#     external: true")]),e._v("\n"),t("span",{attrs:{class:"token comment"}},[e._v("# networks:")]),e._v("\n"),t("span",{attrs:{class:"token comment"}},[e._v("#   net_mysql:")]),e._v("\n"),t("span",{attrs:{class:"token comment"}},[e._v("#     external: true")]),e._v("\n")])]),t("ol",{attrs:{start:"2"}},[t("li",[e._v("mount【推荐使用】")])]),t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=Abcd1234 --name mysql01 --restart always --mount type=bind,src=/docker/mysql/config/my.cnf,dst=/etc/my.cnf --mount type=bind,src=/docker/mysql/data,dst=/var/lib/mysql mysql\n")])]),t("blockquote",[t("p",[e._v("/docker/mysql/config/my.cnf\t  对应物理磁盘位置 需要新建my.cnf 内容如下")])]),t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[mysqld]\nuser=root\ncharacter-set-server=utf8\n[client]\ndefault-character-set=utf8\n[mysql]\ndefault-character-set=utf8\n")])]),t("blockquote",[t("p",[e._v("/etc/my.cnf\t--docker创建mysql后该mysql容器对应的配置文件"),t("br"),e._v("\n/docker/mysql/data\t--对应物理磁盘位置 表示docker中数据映射到的物理文件位置"),t("br"),e._v("\n/var/lib/mysql mysql/mysql-server   对应docker中mysql实例容器的文件位置"),t("br"),e._v("\n-e  MYSQL_ROOT_PASSWORD=Abcd1234  设置初始密码")])]),t("ol",[t("li",[e._v("volume[后期废用]  推荐使用mount形式")])]),t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("docker run -d -p 3306:3306 --name mysql01 -v=/docker/mysql/config/my.cnf:/etc/my.cnf -v=/docker/mysql/data:/var/lib/mysql mysql/mysql-server\n")])]),t("h4",{attrs:{id:"二、使用篇"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、使用篇","aria-hidden":"true"}},[e._v("#")]),e._v(" 二、使用篇")]),t("blockquote",[t("p",[e._v("docker 操作mysql")])]),t("ol",[t("li",[e._v("连接mysql"),t("br"),e._v("\ndocker exec -it mysql01 bash"),t("br"),e._v("\nmysql -u root -p [密码] \t--密码可以待mysql容器启动后"),t("br"),e._v("\n通过docker logs mysql01 找到生成的随机密码 密码在一段类型：\n"),t("img",{attrs:{src:"/images/docker/040101.png",alt:""}})]),t("li",[e._v("设置mysql密码"),t("br"),e._v("\nSET PASSWORD FOR 'root'@'localhost' = PASSWORD('Abcd1234');\t--用户名为root 密码为Abcd1234")]),t("li",[e._v("实验一下\t【--exit 退出当前】"),t("br"),e._v("\nuse mysql;\t--使用数据库查询"),t("br"),e._v("\nselect user,host from user;\t--查询用户信息"),t("br"),e._v("\nshow variables like ‘%char%’;\t\t--查看当前使用的字符集"),t("br"),e._v("\n在mysql中创建网络用户 这样可以非本机访问"),t("br"),e._v("\nmysql> CREATE USER 'sa'@'%' IDENTIFIED BY 'Abcd1234';"),t("br"),e._v("\nmysql> GRANT ALL PRIVILEGES ON "),t("em",[e._v(".")]),e._v(" TO 'sa'@'%';")])]),t("blockquote",[t("p",[e._v('docker run -d -p 3306:3306 -e"MYSQL_USER=Zarc" -e"MYSQL_PASSWORD=pwd123456" -e"MYSQL_ROOT_PASSWORD=password123" -e"MYSQL_RANDOM_ROOT_PASSWORD=true" --name mysql01 mysql/mysql-server --character-set-server=utf8 --collation-server=utf8_general_ci'),t("br"),e._v("\n备注： : When this is true (which is its default state, unless MYSQL_ROOT_PASSWORD is set or MYSQL_ALLOW_EMPTY_PASSWORD is set to true), a random password for the server's root user is generated when the Docker container is started 当这个MYSQL_RANDOM_ROOT_PASSWORD 为true 时 为root用户设置密码是没有作用的还是会生成随机的密码，设置为false 或者不加这个环境变量")])])])}],!1,null,null,null);n.options.__file="04docker_install_mysql.md";s.default=n.exports}}]);